```toml
[advisory]
id = "CVE-2024-32468"
package = "deno"
date = "2024-11-26"
url = "https://www.cve.org/CVERecord?id=CVE-2024-32468"
keywords = ["xss"]
categories = ["memory-exposure"]
aliases = ["https://github.com/denoland/deno/security/advisories/GHSA-qqwr-j9mm-fhw6"]
cvss = "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N"


[versions]
patched = [">= 1.42.0"]
affected = ["< 1.42.0"]
```

# Description

## Summary

Several cross-site scripting vulnerabilities existed in the `deno_doc` crate which lead to Self-XSS with deno doc `--html`.

## Details & PoC

1. XSS in generated `search_index.js`

`deno_doc` outputed a JavaScript file for searching. However, the generated file used `innerHTML` on unsanitzed HTML input.

[https://github.com/denoland/deno_doc/blob/dc556c848831d7ae48f3eff2ababc6e75eb6b73e/src/html/templates/pages/search.js#L120-L144](https://github.com/denoland/deno_doc/blob/dc556c848831d7ae48f3eff2ababc6e75eb6b73e/src/html/templates/pages/search.js#L120-L144)

2. XSS via property, method and enum names

`deno_doc` did not sanitize property names, method names and enum names.

## Impact 

The first XSS most likely didn't have an impact since `deno doc --html` is expected to be used locally with own packages.

