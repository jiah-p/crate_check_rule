```toml
[advisory]
id = "CVE-2025-47737"
package = "trailer"
date = "2025-05-09"
url = "https://www.cve.org/CVERecord?id=CVE-2025-47737"
categories = ["memory-corruption"]
keywords = ["segfault"]
informational = "unsound"

[versions]
patched = ["> 0.1.2"]
affected = ["<= 0.1.2"]
```

# unsound Safety issues in `trailer`

## description

`lib.rs` in the trailer crate through `0.1.2` for Rust mishandles allocating with a size of zero.

## Overview

a potential unsound issue in the construction of Trailer, where it doesn't provide enough check to ensure the soundness.

`trailer/src/lib.rs`

Lines 18 to 25 in d474984
```rs
 pub fn new(capacity: usize) -> Trailer<T> { 
     unsafe { 
         let trailer = Trailer::allocate(capacity); 
         let ptr = trailer.ptr as *mut T; 
         ptr.write(T::default()); 
         trailer 
     } 
 } 
The constructor does check the T is not a ZST in rust, and allocating with size 0 is considered as undefined behaviors in Rust. A poc code like below can work:
```

```rs
use trailer::Trailer;
#[derive(Default)]
struct Zst;

fn main() {
    let mut a = Trailer::<Zst>::new(0);
    drop(a);
}
```

### References

- [https://github.com/Geal/trailer/issues/2](https://github.com/Geal/trailer/issues/2)
- [https://crates.io/crates/trailer ](https://crates.io/crates/trailer )