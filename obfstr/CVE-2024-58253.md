```toml
[advisory]
id = "CVE-2024-58253"
package = "obfstr"
date = "2025-05-02"
url = "https://www.cve.org/CVERecord?id=CVE-2024-58253"
categories = ["type-confusion"]
cvss = "CVSS:3.1/AV:L/AC:H/PR:N/UI:N/S:U/C:N/I:L/A:N"

[versions]
patched = ["> 0.4.4"]
affected = ["<= 0.4.4"]
```


# Description

In the obfstr crate before 0.4.4 for Rust, the obfstr! argument type is not restricted to string slices, leading to invalid UTF-8 conversion that produces an invalid value.

## Details

there might be an unsound issue in your unsafe_as_str converting the bytes to utf8 str:

```rs
pub fn unsafe_as_str(bytes: &[u8]) -> &str { 
 	// When used correctly by this crate's macros this should be safe 
 	#[cfg(debug_assertions)] 
 	return str::from_utf8(bytes).unwrap(); 
 	#[cfg(not(debug_assertions))] 
 	return unsafe { str::from_utf8_unchecked(bytes) }; 
 } 
```

## References

- [https://github.com/CasualX/obfstr/issues/60 ](https://github.com/CasualX/obfstr/issues/60)
- [https://github.com/CasualX/obfstr/compare/v0.4.3...v0.4.4](https://github.com/CasualX/obfstr/compare/v0.4.3...v0.4.4)