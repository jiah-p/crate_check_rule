```toml
[advisory]
id = "CVE-2024-51502"
package = "loona-hpack"
date = "2024-11-03"
url = "https://www.cve.org/CVERecord?id=CVE-2024-51502"
# keywords = ["example", "freeform", "keywords"]
categories = ["memory-exposure"]
aliases = ["https://github.com/bearcove/loona/security/advisories/GHSA-7vm6-qwh5-9x44"]
# cvss = "CVSS:4.0/AV:N/AC:H/AT:N/PR:L/UI:N/VC:L/VI:H/VA:N/SC:H/SI:H/SA:H"

[versions]
patched = [">= 0.4.3"]
affected = ["<= 0.4.2"]
```

# Description

loona is an experimental, HTTP/1.1 and HTTP/2 implementation in Rust on top of io-uring. `loona-hpack` suffers from the same vulnerability as the original `hpack` as documented in `issue #11`. All users who try to decode untrusted input using the Decoder are vulnerable to this exploit. This issue has been addressed in release version `0.4.3`. All users are advised to upgrade. There are no known workarounds for this vulnerability.",

## Summary

`loona-hpack` suffers from the same vulnerability as the original hpack as documented in [mlalic/hpack-rs#11](https://github.com/mlalic/hpack-rs/issues/11)

## Details

The original includes a very nice description of the problem, as well as an easy-enough fix for it.

## PoC

The original example pretty much still applies:
```rs
use loona_hpack::Decoder;

pub fn main() {
    let input = &[0x3f];
    let mut decoder = Decoder::new();
    let _ = decoder.decode(input);
}
```

## Impact 

From the original:

All users who try to decode untrusted input using the Decoder are vulnerable to this exploit. A patched version of the crate is available on [crates.io](https://crates.io/crates/hpack-patched) under the name `hpack-patched`. See [Cargo's documentation on overriding dependencies](https://doc.rust-lang.org/cargo/reference/overriding-dependencies.html) for more information.

